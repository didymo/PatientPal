<div class="navigation" *ngIf="survey">
    <button class="btn toolbar-item" routerLink="/tab-views">
        Return
    </button>
    <button class="btn btn-light toolbar-item" id="exp-btn1" (click)="setPreview()"
            checked="false"
            [disabled]=previewDisabled>
        Preview
    </button>

    <button class="btn toolbar-item" (click)="submit()">
        Save
    </button>
    <button class="btn toolbar-item" (click)="publish()">
        Publish
    </button>
    <button class="btn btn-light toolbar-item" (click)="exportAsXLSX()">
        Export
    </button>
    <button class="btn btn-light toolbar-item" id="exp-btn" (click)="deploy()">
        Deploy
    </button>
    <button
            *ngIf="innerWidth > 765"
            class="btn btn-light toolbar-item"
            [disabled]="disabled"
            (click)="setToggle()"
            id="livePreview"
            color="primary">
        Live Preview
    </button>
    <div class="col-lg-7 toolbar-title" *ngIf="survey">
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="basic-addon1">Survey Title</span>
            </div>
            <input type="text" class="form-control" id="surveyTitle" [value]="survey.tabDesc" style="font-weight: bold">
        </div>
    </div>

</div>
<br>
<div>
    <div id="wrapper" *ngIf="survey">
        <div id="questions"
             [@openPreview]="isPreview ? 'hideEdit' : 'visible'"
             [@openClose]="isOpen ? 'open' : 'closed'"
             [@fullPreview]="isPreview ? 'open': 'closed'"
             class="open-close-container">
            <cdk-virtual-scroll-viewport style="height: 87vh" itemSize="90">
                <form (ngSubmit)="saveSurvey()" id="form">
                    <div cdkDropList class="assessment-list" (cdkDropListDropped)="drop($event)">
                        <div *ngFor="let assessments of survey.assessments; let i = index" id="assessments"
                             class="assessment-item" cdkDrag>
                            <div class="title-div">
                                <div class="imgView" *ngIf="assessments.asessmentType.toString() === '5'">
                                    <img src="assets/icons/select.png" width="24" height="24" class="rounded float-left"
                                         alt="">
                                </div>
                                <div class="imgView" *ngIf="assessments.asessmentType.toString() === '4'">
                                    <img src="assets/icons/texts.png" width="24" height="24" class="rounded float-left"
                                         alt="">
                                </div>
                                <div class="title-div-child1">
                                    <p style="font-weight: bold">{{i + 1}}.</p>
                                </div>
                                <div class="title-div-child2">
                                    <input class="form-control"
                                           [value]="assessments.assessmentDesc"
                                           [(ngModel)]="survey.assessments[i].assessmentDesc"
                                           (ngModelChange)="preview.changeTitle(i,$event)"
                                           [ngModelOptions]="{standalone: true}"
                                           [attr.id]=assessments.id style="font-weight: bold">
                                </div>
                            </div>

                            <!--Assessment 5-->
                            <div id="ass5" *ngIf="assessments.asessmentType.toString() === '5'">

                                <div id="option-div-parent1" *ngFor="let choices of assessments.choices let x = index">
                                    <div id="option-div-child">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">Option {{x + 1}}</span>
                                        </div>
                                        <textarea
                                                [(ngModel)]="survey.assessments[i].choices[x].choiceDesc"
                                                [ngModelOptions]="{standalone: true}"
                                                (ngModelChange)="saveQuestion(i, x, false)"
                                                [value]="choices.choiceDesc"
                                                [attr.id]=assessments.choices[x].id
                                                class="form-control" rows="2"
                                        >
                                </textarea>
                                    </div>
                                </div>
                                <div id="btn-div-1">

                                    <div class="submit-child">
                                        <button id="mandatory" class="btn btn-primary">
                                            Mandatory
                                        </button>
                                    </div>
                                    <div ngbDropdown placement="top-right" class="d-inline-block">
                                        <button class="btn btn-primary" id="dropdownBasic1" ngbDropdownToggle>Toggle
                                            dropdown
                                        </button>
                                        <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                                            <button ngbDropdownItem (click)="preview.createRadioGroup(i, false)">Radio
                                                Buttons
                                            </button>
                                            <button ngbDropdownItem (click)="preview.createSelect(i, false)">Select One
                                            </button>
                                            <button ngbDropdownItem (click)="preview.createSelectMany(i , false)">Select
                                                Many
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!--Assessment 4-->
                            <div id="ass4" *ngIf="assessments.asessmentType.toString() === '4'">
                                <div id="option-div-parent2">
                                </div>
                                <div id="btn-div-2">
                                    <div class="submit-child">
                                        <button id="mandatory" class="btn btn-primary">
                                            Mandatory
                                        </button>
                                    </div>
                                    <div ngbDropdown placement="top-right" class="d-inline-block">
                                        <button class="btn btn-primary" id="dropdownBasic2" ngbDropdownToggle>Toggle
                                            dropdown
                                        </button>
                                        <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                                            <button ngbDropdownItem (click)="preview.createText(i, false)">Text Field
                                            </button>
                                            <button ngbDropdownItem (click)="preview.createNumber(i, false)">Number
                                                Field
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                </form>
            </cdk-virtual-scroll-viewport>
        </div>
        <ng-container>
            <div id="preview" *ngIf="survey"
                 [@openPreview]="isOpen ? 'hidden' : 'visible'"
                 [@fullPreview]="fullPreview ? 'open' : 'close'"
            >
                <cdk-virtual-scroll-viewport style="height: 85vh" itemSize="90">
                <!--                    <app-form-builder [survey]="survey"></app-form-builder>-->
                    <app-preview></app-preview>
                </cdk-virtual-scroll-viewport>
            </div>
        </ng-container>
    </div>
</div>
